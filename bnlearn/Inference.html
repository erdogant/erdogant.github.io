

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Inference &mdash; bnlearn bnlearn documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Sampling and datasets" href="Sampling and datasets.html" />
    <link rel="prev" title="Parameter learning" href="Parameter learning.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> bnlearn
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html#validate">Validate</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html#uninstalling">Uninstalling</a></li>
</ul>
<p class="caption"><span class="caption-text">Quickstart</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">Quickstart</a></li>
</ul>
<p class="caption"><span class="caption-text">Methods</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Structure learning.html">Structure learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parameter learning.html">Parameter learning</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Inference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#algorithms">Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples-inference">Examples Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-inference-1">Example Inference 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-inference-2">Example Inference 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-inference-3">Example Inference 3</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Sampling and datasets.html">Sampling and datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Create DAG.html">Directed Acyclic Graphs</a></li>
</ul>
<p class="caption"><span class="caption-text">Additional Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="API Reference.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bnlearn</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Inference</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Inference.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="inference">
<h1>Inference<a class="headerlink" href="#inference" title="Permalink to this headline">¶</a></h1>
<p>The basic concept of variable elimination is same as doing marginalization over Joint Distribution.
But variable elimination avoids computing the Joint Distribution by doing marginalization over much smaller factors.
So basically if we want to eliminate <strong>X</strong> from our distribution, then we compute
the product of all the factors involving <strong>X</strong> and marginalize over them,
thus allowing us to work on much smaller factors.</p>
<div class="section" id="algorithms">
<h2>Algorithms<a class="headerlink" href="#algorithms" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>The main categories for inference algorithms:</dt><dd><ol class="arabic simple">
<li><p>Exact Inference: These algorithms find the exact probability values for our queries.</p></li>
<li><p>Approximate Inference: These algorithms try to find approximate values by saving on computation.</p></li>
</ol>
</dd>
<dt><strong>Two common Inference algorithms with variable Elimination</strong></dt><dd><ol class="loweralpha simple">
<li><p>Clique Tree Belief Propagation</p></li>
<li><p>Variable Elimination</p></li>
</ol>
</dd>
</dl>
</div>
<div class="section" id="examples-inference">
<h2>Examples Inference<a class="headerlink" href="#examples-inference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-inference-1">
<h3>Example Inference 1<a class="headerlink" href="#example-inference-1" title="Permalink to this headline">¶</a></h3>
<p>Lets load the Sprinkler data set and make some inferences.</p>
<p>What is the probability of <em>wet grass</em> given that it <em>Rains</em>, and the <em>sprinkler</em> is off and its <em>cloudy</em>: P(wet grass | rain=1, sprinkler=0, cloudy=1)?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">bnlearn</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">import_DAG</span><span class="p">(</span><span class="s1">&#39;sprinkler&#39;</span><span class="p">)</span>
<span class="n">q1</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Wet_Grass&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Rain&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Sprinkler&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Cloudy&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>The probability having wet grass is 0.9 and not-wet-gras is 0.1.</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Wet_Grass</p></th>
<th class="head"><p>phi(Wet_Grass)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Wet_Grass(0)</p></td>
<td><p>0.1000</p></td>
</tr>
<tr class="row-odd"><td><p>Wet_Grass(1)</p></td>
<td><p>0.9000</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="example-inference-2">
<h3>Example Inference 2<a class="headerlink" href="#example-inference-2" title="Permalink to this headline">¶</a></h3>
<p>What is the probability of wet grass given and Rain given that the <em>Sprinkler</em> is on?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q2</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Wet_Grass&#39;</span><span class="p">,</span><span class="s1">&#39;Rain&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Sprinkler&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>The highest probability is that in these condition, there is wet grass and no rain (P=0.63)</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 20%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Wet_Grass</p></th>
<th class="head"><p>Rain</p></th>
<th class="head"><p>phi(Wet_Grass,Rain)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Wet_Grass(0)</p></td>
<td><p>Rain(0)</p></td>
<td><p>0.0700</p></td>
</tr>
<tr class="row-odd"><td><p>Wet_Grass(0)</p></td>
<td><p>Rain(1)</p></td>
<td><p>0.0030</p></td>
</tr>
<tr class="row-even"><td><p>Wet_Grass(1)</p></td>
<td><p>Rain(0)</p></td>
<td><p>0.6300</p></td>
</tr>
<tr class="row-odd"><td><p>Wet_Grass(1)</p></td>
<td><p>Rain(1)</p></td>
<td><p>0.2970</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="example-inference-3">
<h3>Example Inference 3<a class="headerlink" href="#example-inference-3" title="Permalink to this headline">¶</a></h3>
<p>Given our model, what is the probability on lung cancer given that the person is a smoker and xray is negative?
P(lung | smoker=1, xray=0)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lets create the dataset</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">import_DAG</span><span class="p">(</span><span class="s1">&#39;asia&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Lets make the inference:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">q1</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lung&#39;</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;xray&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;smoke&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>

<span class="o">+---------+-------------+</span>
<span class="o">|</span> <span class="n">lung</span>    <span class="o">|</span>   <span class="n">phi</span><span class="p">(</span><span class="n">lung</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+=========+=============+</span>
<span class="o">|</span> <span class="n">lung</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">|</span>      <span class="mf">0.1423</span> <span class="o">|</span>
<span class="o">+---------+-------------+</span>
<span class="o">|</span> <span class="n">lung</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span>      <span class="mf">0.8577</span> <span class="o">|</span>
<span class="o">+---------+-------------+</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Sampling and datasets.html" class="btn btn-neutral float-right" title="Sampling and datasets" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Parameter learning.html" class="btn btn-neutral float-left" title="Parameter learning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Erdogan Taskesen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>