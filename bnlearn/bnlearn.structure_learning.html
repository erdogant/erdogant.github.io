

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>structure_learning (API) &mdash; bnlearn bnlearn documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="parameter_learning (API)" href="bnlearn.parameter_learning.html" />
    <link rel="prev" title="API Reference" href="API Reference.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> bnlearn
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html#validate">Validate</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html#uninstalling">Uninstalling</a></li>
</ul>
<p class="caption"><span class="caption-text">Quickstart</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">Quickstart</a></li>
</ul>
<p class="caption"><span class="caption-text">Methods</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Structure learning.html">Structure learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Parameter learning.html">Parameter learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sampling and datasets.html">Sampling and datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Create DAG.html">Directed Acyclic Graphs</a></li>
</ul>
<p class="caption"><span class="caption-text">Additional Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="API Reference.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">structure_learning (API)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bnlearn.parameter_learning.html">parameter_learning (API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="bnlearn.inference.html">Inference (API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="bnlearn.plot.html">plot (API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="bnlearn.import_example.html">import_example (API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="bnlearn.import_DAG.html">import_DAG (API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="bnlearn.print_DAG.html">print DAG (API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="bnlearn.make_DAG.html">make_DAG (API)</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bnlearn</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="API Reference.html">API Reference</a> &raquo;</li>
        
      <li>structure_learning (API)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/bnlearn.structure_learning.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-bnlearn.structure_learning">
<span id="structure-learning-api"></span><h1>structure_learning (API)<a class="headerlink" href="#module-bnlearn.structure_learning" title="Permalink to this headline">¶</a></h1>
<p>Structure learning. Given a set of data samples, estimate a DAG that captures the dependencies between the variables.</p>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Search strategies for structure learning
The search space of DAGs is super-exponential in the number of variables and the above scoring functions allow for local maxima.</p>
<dl class="simple">
<dt>To learn model structure (a DAG) from a data set, there are three broad techniques:</dt><dd><ol class="arabic simple">
<li><dl class="simple">
<dt>Score-based structure learning (BIC/BDeu/K2 score; exhaustive search, hill climb/tabu search)</dt><dd><ol class="loweralpha simple">
<li><p>exhaustivesearch</p></li>
<li><p>hillclimbsearch</p></li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Constraint-based structure learning (PC)</dt><dd><ol class="loweralpha simple">
<li><p>chi-square test</p></li>
</ol>
</dd>
</dl>
</li>
<li><p>Hybrid structure learning (The combination of both techniques) (MMHC)</p></li>
</ol>
</dd>
</dl>
<p>Score-based Structure Learning
This approach construes model selection as an optimization task. It has two building blocks:
A scoring function sD:-&gt;R that maps models to a numerical score, based on how well they fit to a given data set D.
A search strategy to traverse the search space of possible models M and select a model with optimal score.
Commonly used scoring functions to measure the fit between model and data are Bayesian Dirichlet scores such as BDeu or K2
and the Bayesian Information Criterion (BIC, also called MDL).
As before, BDeu is dependent on an equivalent sample size.</p>
<dl class="function">
<dt id="bnlearn.structure_learning.fit">
<code class="sig-prename descclassname">bnlearn.structure_learning.</code><code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">methodtype='hc'</em>, <em class="sig-param">scoretype='bic'</em>, <em class="sig-param">black_list=None</em>, <em class="sig-param">white_list=None</em>, <em class="sig-param">max_indegree=None</em>, <em class="sig-param">verbose=3</em><span class="sig-paren">)</span><a class="headerlink" href="#bnlearn.structure_learning.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure learning fit model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em>(</em><em>)</em>) – Input dataframe.</p></li>
<li><p><strong>methodtype</strong> (<em>str</em><em>, </em><em>optional</em>) – String Search strategy for structure_learning. The default is ‘hc’.
‘hc’ or ‘hillclimbsearch’ (default)
‘ex’ or ‘exhaustivesearch’
‘cs’ or ‘constraintsearch’</p></li>
<li><p><strong>scoretype</strong> (<em>str</em><em>, </em><em>optional</em>) – Scoring function for the search spaces. The default is ‘bic’.
‘bic’
‘k2’
‘bdeu’</p></li>
<li><p><strong>black_list</strong> (<em>List</em><em>, </em><em>optional</em>) – If a list of edges is provided as black_list, they are excluded from the search and the resulting model will not contain any of those edges.. The default is None.
Works only in case of methodtype=’hc’</p></li>
<li><p><strong>white_list</strong> (<em>List</em><em>, </em><em>optional</em>) – If a list of edges is provided as white_list, the search is limited to those edges. The resulting model will then only contain edges that are in white_list. The default is None.
Works only in case of methodtype=’hc’</p></li>
<li><p><strong>max_indegree</strong> (<em>int</em><em>, </em><em>optional</em>) – If provided and unequal None, the procedure only searches among models where all nodes have at most max_indegree parents. The default is None.
Works only in case of methodtype=’hc’</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Print progress to screen. The default is 3.
0: NONE
1: ERROR
2: WARNING
3: INFO (default)
4: DEBUG
5: TRACE</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict with model.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load asia DAG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">import_DAG</span><span class="p">(</span><span class="s1">&#39;asia&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># plot ground truth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sampling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">sampling</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Structure learning of sampled dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_sl</span> <span class="o">=</span> <span class="n">bnlearn</span><span class="o">.</span><span class="n">structure_learning</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">methodtype</span><span class="o">=</span><span class="s1">&#39;hc&#39;</span><span class="p">,</span> <span class="n">scoretype</span><span class="o">=</span><span class="s1">&#39;bic&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot based on structure learning of sampled data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bnlearn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model_sl</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compare networks and make plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bnlearn</span><span class="o">.</span><span class="n">compare_networks</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model_sl</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bnlearn.parameter_learning.html" class="btn btn-neutral float-right" title="parameter_learning (API)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="API Reference.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Erdogan Taskesen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>